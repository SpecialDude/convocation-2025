<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Convocation Ceremony 2025 - Join Us!</title>
    <meta name="description" content="You're invited to celebrate our academic achievement!">
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;600;700&family=Lato:wght@300;400;600;700&family=Crimson+Text:wght@400;600&display=swap" rel="stylesheet">
    
    <!-- Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/howler/2.2.3/howler.min.js"></script>
    
    <style>
        :root {
            --navy: #1a2b4a;
            --navy-light: #2d4266;
            --royal-blue: #1e3a8a;
            --royal-blue-light: #3b5998;
            --gold: #d4af37;
            --gold-light: #f4d03f;
            --cream: #F8F6F1;
            --cream-dark: #E8E4DC;
            --text-dark: #2C2C2C;
            --shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
            --shadow-soft: 0 4px 15px rgba(0, 0, 0, 0.08);
        }

        * {
            margin: 0;
            padding: 0;
            position:relative;
            box-sizing: border-box;
        }

        body {
            font-family: 'Lato', sans-serif;
            background: linear-gradient(135deg, var(--cream) 0%, var(--cream-dark) 100%);
            color: var(--text-dark);
            min-height: 100vh;
            overflow-x: hidden;
        }

        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }

        .page-container {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .academic-border {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 8px;
            background: linear-gradient(90deg, var(--royal-blue) 0%, var(--gold) 50%, var(--royal-blue) 100%);
        }

        .music-control {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index:1 ;
            background: white;
            border: 3px solid var(--gold);
            border-radius: 50%;
            width: 55px;
            height: 55px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: var(--shadow);
            transition: transform 0.3s ease;
        }

        .music-control:hover {
            transform: scale(1.1);
        }

        .music-control svg {
            width: 26px;
            height: 26px;
            fill: var(--royal-blue);
        }

        .diploma-container {
            perspective: 1500px;
            position: relative;
        }

        .envelope-wrapper {
            position: relative;
            width: 700px;
            max-width: 95vw;
            height: 450px;
            cursor: pointer;
        }

        .envelope {
            width: 100%;
            height: 100%;
            position: relative;
            transform-style: preserve-3d;
        }

        .envelope-back {
            position: absolute;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--royal-blue) 0%, var(--navy) 100%);
            border-radius: 12px;
            box-shadow: var(--shadow);
        }

        .envelope-flap {
            position: absolute;
            width: 100%;
            height: 50%;
            background: linear-gradient(135deg, var(--royal-blue-light) 0%, var(--royal-blue) 100%);
            transform-origin: top center;
            border-radius: 12px 12px 0 0;
            clip-path: polygon(0 0, 100% 0, 75% 100%, 25% 100%);
            z-index: 3;
            pointer-events: none;
        }

        .envelope-flap.opened {
            z-index: 1;
        }

        .wax-seal {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 80px;
            height: 80px;
            background: var(--gold);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--navy);
            font-family: 'Cormorant Garamond', serif;
            font-size: 36px;
            font-weight: 700;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            z-index: 4;
            border: 4px solid var(--gold-light);
        }

        .diploma {
            position: absolute;
            width: 700px;
            max-width: 95vw;
            background: white;
            border-radius: 16px;
            box-shadow: var(--shadow);
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            opacity: 0;
            z-index: 10;
            overflow: hidden;
        }

        .diploma::before {
            content: '';
            position: absolute;
            top: 12px;
            left: 12px;
            right: 12px;
            bottom: 12px;
            /* border: 3px double var(--gold); */
            border-radius: 8px;
            pointer-events: none;
        }

        .diploma-seal {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 80px;
            height: 80px;
            background: radial-gradient(circle, var(--royal-blue) 0%, var(--navy) 100%);
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: white;
            font-family: 'Cormorant Garamond', serif;
            font-weight: 700;
            box-shadow: var(--shadow-soft);
            z-index: 10;
            border: 4px solid var(--gold);
        }

        .seal-year {
            font-size: 24px;
            line-height: 1;
        }

        .seal-text {
            font-size: 10px;
            letter-spacing: 1px;
            text-transform: uppercase;
        }

        .letter {
            padding: 50px 40px;
            max-height: 85vh;
            max-width: 90%;
            margin: 30px auto;
            overflow-y: auto;
            z-index: 1;
            scroll-behavior: smooth;
            border: 3px double var(--gold);
            border-radius: 10px;
        }


        .letter-header {
            text-align: center;
            margin-bottom: 35px;
            padding-top: 20px;
        }

        .graduation-icon {
            width: 60px;
            height: 60px;
            margin: 0 auto 20px;
            fill: var(--royal-blue);
        }

        .letter-title {
            font-family: 'Cormorant Garamond', serif;
            font-size: 42px;
            color: var(--royal-blue);
            margin-bottom: 8px;
            font-weight: 700;
            line-height: 1.2;
        }

        .letter-subtitle {
            color: var(--royal-blue);
            font-size: 13px;
            text-transform: uppercase;
            letter-spacing: 3px;
            font-weight: 600;
        }

        .divider {
            width: 80px;
            height: 2px;
            background: var(--gold);
            margin: 15px auto;
        }

        .letter-content {
            font-family: 'Crimson Text', serif;
            font-size: 16px;
            line-height: 1.8;
            margin-bottom: 25px;
            color: var(--text-dark);
            text-align: center;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .letter-content p {
            margin-bottom: 16px;
        }

        .celebrants-title {
            font-family: 'Cormorant Garamond', serif;
            font-size: 24px;
            color: var(--royal-blue);
            text-align: center;
            margin: 35px 0 25px;
            font-weight: 600;
        }

        .rsvp-section {
            margin-top: 35px;
            padding-top: 35px;
            border-top: 2px solid var(--cream-dark);
        }

        .rsvp-title {
            font-family: 'Cormorant Garamond', serif;
            font-size: 28px;
            color: var(--royal-blue);
            margin-bottom: 25px;
            text-align: center;
            font-weight: 600;
        }

        .form-group {
            margin-bottom: 22px;
        }

        .form-label {
            display: block;
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--navy);
            font-size: 14px;
        }

        .form-input {
            width: 100%;
            padding: 14px 16px;
            border: 2px solid var(--cream-dark);
            border-radius: 8px;
            font-family: 'Lato', sans-serif;
            font-size: 15px;
            transition: all 0.3s ease;
            background: white;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--navy);
            box-shadow: 0 0 0 3px rgba(26, 43, 74, 0.1);
        }

        textarea.form-input {
            resize: vertical;
            min-height: 90px;
        }

        .celebrants-grid {
            display: flex;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
            margin: 20px auto;
            max-width: 100%;
        }

        .celebrant-card {
            position: relative;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            padding: 12px;
            border-radius: 12px;
            border: 3px solid transparent;
            background: var(--cream);
            width: 150px;
            flex-shrink: 0;
        }

        .celebrant-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-soft);
        }

        .celebrant-card.selected {
            border-color: var(--royal-blue);
            background: white;
            box-shadow: 0 4px 20px rgba(30, 58, 138, 0.2);
        }

        .celebrant-avatar {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            margin: 0 auto 10px;
            background: linear-gradient(135deg, var(--royal-blue) 0%, var(--royal-blue-light) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 26px;
            font-weight: 700;
            font-family: 'Cormorant Garamond', serif;
            border: 3px solid white;
            box-shadow: var(--shadow-soft);
            transition: all 0.3s ease;
            
        }

        .celebrant-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;     /* crop nicely */
            border-radius: inherit; /* matches parent radius */
            
        }

        .celebrant-card.selected .celebrant-avatar {
            border-color: var(--gold);
            transform: scale(1.05);
        }

        .celebrant-name {
            font-weight: 600;
            color: var(--royal-blue);
            font-size: 13px;
            margin-bottom: 3px;
        }

        .celebrant-degree {
            font-size: 10px;
            color: #666;
            font-style: italic;
        }

        .checkbox-icon {
            position: absolute;
            top: 8px;
            right: 8px;
            width: 22px;
            height: 22px;
            border-radius: 50%;
            background: var(--royal-blue);
            display: none;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 12px;
        }

        .celebrant-card.selected .checkbox-icon {
            display: flex;
        }

        .submit-btn, .secondary-btn {
            width: 100%;
            padding: 16px;
            border: none;
            border-radius: 10px;
            font-family: 'Lato', sans-serif;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .submit-btn {
            background: linear-gradient(135deg, var(--royal-blue) 0%, var(--royal-blue-light) 100%);
            color: white;
            margin-bottom: 12px;
            box-shadow: var(--shadow-soft);
        }

        .submit-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        .submit-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .secondary-btn {
            background: transparent;
            color: var(--royal-blue);
            border: 2px solid var(--royal-blue);
        }

        .secondary-btn:hover {
            background: var(--royal-blue);
            color: white;
        }

        .success-message, .error-message {
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            text-align: center;
            font-weight: 500;
        }

        .success-message {
            background: #d4edda;
            color: #155724;
            border: 2px solid #c3e6cb;
        }

        .error-message {
            background: #f8d7da;
            color: #721c24;
            border: 2px solid #f5c6cb;
        }

        .guest-list-container {
            max-width: 1000px;
            width: 100%;
            background: white;
            border-radius: 16px;
            padding: 45px;
            box-shadow: var(--shadow);
            position: relative;
            overflow: hidden;
        }

        .guest-list-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 6px;
            background: linear-gradient(90deg, var(--royal-blue) 0%, var(--gold) 50%, var(--royal-blue) 100%);
        }

        .guest-list-header {
            text-align: center;
            margin-bottom: 35px;
        }

        .guest-list-title {
            font-family: 'Cormorant Garamond', serif;
            font-size: 40px;
            color: var(--navy);
            margin-bottom: 12px;
            font-weight: 700;
        }

        .last-updated {
            color: #666;
            font-size: 14px;
            font-style: italic;
        }

        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 35px;
        }

        .stat-card {
            padding: 25px;
            border-radius: 12px;
            text-align: center;
            border: 3px solid;
        }

        .stat-card.total {
            background: linear-gradient(135deg, rgba(30, 58, 138, 0.05) 0%, rgba(30, 58, 138, 0.1) 100%);
            border-color: var(--royal-blue);
        }

        .stat-card.accepted {
            background: rgba(212, 175, 55, 0.1);
            border-color: var(--gold);
        }

        .stat-number {
            font-size: 40px;
            font-weight: 700;
            margin-bottom: 8px;
            font-family: 'Cormorant Garamond', serif;
            color: var(--royal-blue);
        }

        .stat-label {
            font-size: 13px;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            font-weight: 600;
            color: var(--royal-blue);
        }

        .guest-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 30px;
        }

        .guest-table th {
            background: var(--royal-blue);
            color: white;
            padding: 18px;
            text-align: left;
            font-weight: 700;
            font-size: 13px;
            text-transform: uppercase;
            letter-spacing: 1.5px;
        }

        .guest-table td {
            padding: 18px;
            border-bottom: 1px solid var(--cream-dark);
        }

        .guest-table tr:hover {
            background: var(--cream);
        }

        .guest-number {
            color: var(--royal-blue);
            font-weight: 700;
            font-size: 16px;
        }

        .celebrant-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
        }

        .celebrant-tag {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            background: var(--royal-blue);
            color: white;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .loading {
            text-align: center;
            padding: 50px;
            color: var(--royal-blue);
        }

        .spinner {
            border: 4px solid var(--cream-dark);
            border-top: 4px solid var(--royal-blue);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .hidden {
            display: none !important;
        }

        .selection-note {
            text-align: center;
            font-size: 13px;
            color: #666;
            font-style: italic;
            margin-top: 10px;
        }

        @media (max-width: 768px) {
            .envelope-wrapper {
                width: 95vw;
                height: 400px;
            }

            .diploma {
                width: 95vw;
            }

            .letter {
                padding: 40px 25px;
            }

            .letter-title {
                font-size: 32px;
            }

            .diploma-seal {
                width: 65px;
                height: 65px;
                top: 15px;
                right: 15px;
            }

            .seal-year {
                font-size: 20px;
            }

            .wax-seal {
                width: 65px;
                height: 65px;
                font-size: 30px;
            }

            .music-control {
                width: 48px;
                height: 48px;
                top: 15px;
                right: 15px;
            }

            .music-control svg {
                width: 22px;
                height: 22px;
            }

            .celebrants-grid {
                grid-template-columns: repeat(auto-fit, minmax(90px, 1fr));
                gap: 15px;
            }

            .celebrant-avatar {
                width: 70px;
                height: 70px;
                font-size: 24px;
                
            }

            .guest-list-container {
                padding: 30px 20px;
            }

            .guest-table {
                font-size: 13px;
            }

            .guest-table th,
            .guest-table td {
                padding: 12px 8px;
            }

            .stats-container {
                grid-template-columns: 1fr;
            }
        }


        @media (max-width: 500px) {

            .celebrant-card{
                width: 120px;
            }
        }

        .letter::-webkit-scrollbar {
            width: 1px;
        }

        .letter::-webkit-scrollbar-track {
            background: var(--cream);
        }

        .letter::-webkit-scrollbar-thumb {
            background: var(--gold);
            border-radius: 4px;
        }

        .letter::-webkit-scrollbar-thumb:hover {
            background: var(--burgundy);
        }
    </style>
</head>
<body>
    <div class="academic-border"></div>

    <div class="music-control" id="musicControl" title="Play music" role="button" tabindex="0" aria-label="Toggle music">
        <svg id="playIcon" viewBox="0 0 24 24">
            <path d="M8 5v14l11-7z"/>
        </svg>
        <svg id="pauseIcon" class="hidden" viewBox="0 0 24 24">
            <path d="M6 4h4v16H6V4zm8 0h4v16h-4V4z"/>
        </svg>
    </div>

    <div class="page-container" id="invitationPage">
        <div class="diploma-container">
            <div class="envelope-wrapper" id="envelopeWrapper">
                <div class="envelope">
                    <div class="envelope-back"></div>
                    <div class="envelope-flap">
                        <div class="wax-seal">ðŸŽ“</div>
                    </div>
                    <div class="diploma" id="diploma">
                        <div class="diploma-seal">
                            <div class="seal-year">2025</div>
                            <div class="seal-text">Graduate</div>
                        </div>
  <div class="overlay">


                            </div>
                        <div class="letter" id="letter">
                          
                            <div class="letter-header">
                                <svg class="graduation-icon" viewBox="0 0 24 24">
                                    <path d="M12 3L1 9l11 6 9-4.91V17h2V9M5 13.18v4L12 21l7-3.82v-4L12 17l-7-3.82z"/>
                                </svg>
                                <h1 class="letter-title">You're Invited!</h1>
                                <div class="divider"></div>
                                <p class="letter-subtitle">Joint Convocation Celebration</p>
                            </div>
                            
                            <div class="letter-content">
                                <p>Dear Esteemed Guest,</p>
                                
                                <p>It is with immense joy and pride that we invite you to celebrate a significant milestone in our lives â€” our graduation! After years of dedication, perseverance, and countless memorable moments, we have arrived at a defining moment in our academic journey.</p>
                                
                                <p>This convocation ceremony marks not just the end of our studies, but the beginning of new adventures, opportunities, and dreams realized. We would be honored to have you join us as we celebrate this momentous achievement together.</p>
                                
                                <p>Your presence, encouragement, and support have been invaluable throughout this journey, and sharing this special day with you would make it all the more meaningful.</p>
                            </div>

                            <h3 class="celebrants-title">Celebrating Our Graduates</h3>

                            <div class="rsvp-section">
                                <h2 class="rsvp-title">Confirm Your Attendance</h2>
                                
                                <div id="rsvpForm">
                                    <div class="form-group">
                                        <label class="form-label" for="guestName">Full Name *</label>
                                        <input type="text" id="guestName" name="name" class="form-input" required minlength="2" maxlength="100" placeholder="Enter your full name">
                                    </div>

                                    <div class="form-group">
                                        <label class="form-label" for="guestEmail">Email Address (Optional)</label>
                                        <input type="email" id="guestEmail" name="email" class="form-input" placeholder="your.email@example.com">
                                    </div>

                                    <div class="form-group">
                                        <label class="form-label">Who are you celebrating with? *</label>
                                        <p class="selection-note">Select one or more graduates you're coming to celebrate</p>
                                        
                                        <div class="celebrants-grid" id="celebrantsGrid">
                                            <div class="celebrant-card" data-celebrant="Aeorck">
                                                <div class="checkbox-icon">âœ“</div>
                                                <div class="celebrant-avatar"><img src="https://i.ibb.co/vxdGDY2J/Godwin-Image.jpg" alt="Godwin Daniel"></div>
                                                <div class="celebrant-name">Aeorck</div>
                                                <div class="celebrant-degree">BSc. Computer Science</div>
                                            </div>
                                            
                                            <div class="celebrant-card" data-celebrant="Timadey">
                                                <div class="checkbox-icon">âœ“</div>
                                                <div class="celebrant-avatar"><img src="https://i.ibb.co/B2WJTSnz/TImadey.jpg" alt="Timothy Adeleke"></div>
                                                <div class="celebrant-name">Timadey</div>
                                                <div class="celebrant-degree">BSc. Computer Science</div>
                                            </div>
                                            
                                            <div class="celebrant-card" data-celebrant="El's">
                                                <div class="checkbox-icon">âœ“</div>
                                                <div class="celebrant-avatar"><img src="https://i.ibb.co/TBKjs4xv/Emmanuel.jpg" alt="Eniola Olawale"></div>
                                                <div class="celebrant-name">El's</div>
                                                <div class="celebrant-degree">BSc. Computer Science</div>
                                            </div>
                                            
                                            <div class="celebrant-card" data-celebrant="NerdyX">
                                                <div class="checkbox-icon">âœ“</div>
                                                <div class="celebrant-avatar"><img src="https://i.ibb.co/9m8wzy7M/Micheal-Oluwayemi.png" alt="Micheal Oluwayemi"></div>
                                                <div class="celebrant-name">NerdyX</div>   
                                                <div class="celebrant-degree">BSc. Computer Science</div>
                                            </div>
                                            
                                            <div class="celebrant-card" data-celebrant="AWA">
                                                <div class="checkbox-icon">âœ“</div>
                                                <div class="celebrant-avatar"><img src="https://i.ibb.co/0jwbSgn2/IMG-20211030-220955-080.jpg" alt="IMG-20211030-220955-080"></div>
                                                <div class="celebrant-name">AWA</div>
                                                <div class="celebrant-degree">BSc. Computer Science</div>
                                            </div>
                                        </div>
                                        
                                        <input type="hidden" id="celebrantsInput" name="celebrating" required>
                                    </div>

                                    <div class="form-group">
                                        <label class="form-label" for="notes">Special Notes (Optional)</label>
                                        <textarea id="notes" name="notes" class="form-input" maxlength="500" placeholder="Any special message for the celebrants..."></textarea>
                                    </div>

                                    <button type="button" class="submit-btn" id="submitBtn">Confirm Attendance</button>
                                </div>

                                <div id="successMessage" class="success-message hidden"></div>
                                <div id="errorMessage" class="error-message hidden"></div>

                                <button class="secondary-btn" onclick="showGuestList()">View Guest List</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="page-container hidden" id="guestListPage">
        <div class="guest-list-container">
            <div class="guest-list-header">
                <h1 class="guest-list-title">Guest Registry</h1>
                <p class="last-updated" id="lastUpdated">Loading...</p>
            </div>

            <div class="stats-container">
                <div class="stat-card total">
                    <div class="stat-number" id="totalCount">0</div>
                    <div class="stat-label">Total Guests</div>
                </div>
                <div class="stat-card accepted">
                    <div class="stat-number" id="celebrantsCount">0</div>
                    <div class="stat-label">Celebrants</div>
                </div>
            </div>

            <div id="loadingState" class="loading">
                <div class="spinner"></div>
                <p>Loading guest registry...</p>
            </div>

            <table class="guest-table hidden" id="guestTable">
                <thead>
                    <tr>
                        <th style="width: 60px;">#</th>
                        <th>Guest Name</th>
                        <th>Celebrating</th>
                    </tr>
                </thead>
                <tbody id="guestTableBody"></tbody>
            </table>

            <button class="secondary-btn" onclick="showInvitation()">Back to Invitation</button>
        </div>
    </div>

    <script>
        // ========== CONFIGURATION ==========
        const CONFIG = {
            googleSheetUrl: 'https://docs.google.com/spreadsheets/d/1b-1rpLFWA_XSaYZXvy1GM0nh5bRuVoTwpQdjJizuDbU/export?format=csv&gid=0',
            web3formsAccessKey: 'd1405fa5-0d74-468f-9651-2006544cb5f2',
            web3formsEndpoint: 'https://api.web3forms.com/submit',
            audioUrl: 'https://www.bensound.com/bensound-music/bensound-adventure.mp3'
        };

        // ========== MUSIC SETUP ==========
        let sound = null;
        let isPlaying = false;

        function initMusic() {
            sound = new Howl({
                src: [CONFIG.audioUrl],
                loop: true,
                volume: 0.3,
                html5: true,
                autoplay: false,
                onplay: function() {
                    isPlaying = true;
                    document.getElementById('playIcon').classList.add('hidden');
                    document.getElementById('pauseIcon').classList.remove('hidden');
                },
                onpause: function() {
                    isPlaying = false;
                    document.getElementById('playIcon').classList.remove('hidden');
                    document.getElementById('pauseIcon').classList.add('hidden');
                },
                onloaderror: function() {
                    console.log('Music loading error');
                },
                onplayerror: function() {
                    console.log('Music play error');
                    sound.once('unlock', function() {
                        sound.play();
                    });
                }
            });
        }

        function toggleMusic() {
            if (!sound) initMusic();
            
            if (isPlaying) {
                sound.pause();
            } else {
                sound.play();
            }
        }

        document.getElementById('musicControl').addEventListener('click', toggleMusic);
        // document.getElementById('musicControl').addEventListener('keypress', (e) => {
        //     if (e.key === 'Enter' || e.key === ' ') {
        //         e.preventDefault();
        //         toggleMusic();
        //     }
        // });

        // ========== CELEBRANT SELECTION ==========
        const selectedCelebrants = new Set();
        const celebrantCards = document.querySelectorAll('.celebrant-card');
        const celebrantsInput = document.getElementById('celebrantsInput');

        celebrantCards.forEach(card => {
            card.addEventListener('click', () => {
                const celebrant = card.dataset.celebrant;
                
                if (selectedCelebrants.has(celebrant)) {
                    selectedCelebrants.delete(celebrant);
                    card.classList.remove('selected');
                } else {
                    selectedCelebrants.add(celebrant);
                    card.classList.add('selected');
                }
                
                updateCelebrantsInput();
            });
        });

        function updateCelebrantsInput() {
            const names = Array.from(selectedCelebrants).map(id => {
                const card = document.querySelector(`[data-celebrant="${id}"]`);
                return card.querySelector('.celebrant-name').textContent;
            });
            celebrantsInput.value = names.join(', ');
        }

        // ========== ENTRANCE ANIMATION ==========
        let animationPlayed = false;

        function animateEnvelope() {
            if (animationPlayed) return;
            animationPlayed = true;

            const envelopeWrapper = document.getElementById('envelopeWrapper');
            const flap = document.querySelector('.envelope-flap');
            const seal = document.querySelector('.wax-seal');
            const diploma = document.getElementById('diploma');

            if (!sound) initMusic();
            if (!isPlaying) {
                sound.play();
            }

            const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;

            if (prefersReducedMotion) {
                flap.style.transform = 'rotateX(-180deg)';
                seal.style.opacity = '0';
                diploma.style.opacity = '1';
                diploma.style.transform = 'translate(-50%, -50%) scale(1)';
                triggerConfetti();
                return;
            }

            const tl = gsap.timeline({ defaults: { ease: 'power2.inOut' } });

            tl.to(seal, {
                scale: 0,
                opacity: 0,
                rotation: 360,
                duration: 0.6
            })
            .to(flap, {
                rotateX: -180,
                duration: 1.2,
                transformOrigin: 'top center',
                onComplete: () => {
                    flap.classList.add('opened');
                }
            })
            .to(diploma, {
                opacity: 1,
                y: -50,
                scale: 1.1,
                duration: 1,
                ease: 'back.out(1.2)'
            }, '-=0.5')
            .to(diploma, {
                y: 0,
                scale: 1,
                duration: 0.7,
                ease: 'power2.out',
                onComplete: triggerConfetti
            });
        }

        document.getElementById('envelopeWrapper').addEventListener('click', function() {
            animateEnvelope();
        });

        // document.getElementById('envelopeWrapper').addEventListener('keypress', function(e) {
        //     if (e.key === 'Enter' || e.key === ' ') {
        //         e.preventDefault();
        //         animateEnvelope();
        //     }
        // });

        function triggerConfetti() {
            confetti({
                particleCount: 100,
                spread: 70,
                origin: { y: 0.6 },
                colors: ['#1e3a8a', '#3b5998', '#d4af37', '#f4d03f']
            });
        }

        window.addEventListener('load', () => {
            initMusic();
            setTimeout(() => {
                animateEnvelope();
            }, 1000);
        });

        // ========== FORM HANDLING ==========
        const submitBtn = document.getElementById('submitBtn');
        const successMessage = document.getElementById('successMessage');
        const errorMessage = document.getElementById('errorMessage');

        submitBtn.addEventListener('click', async () => {
            const guestName = document.getElementById('guestName').value.trim();
            const guestEmail = document.getElementById('guestEmail').value.trim();
            const notes = document.getElementById('notes').value.trim();
            
            if (!guestName) {
                errorMessage.textContent = 'Please enter your full name.';
                errorMessage.classList.remove('hidden');
                setTimeout(() => errorMessage.classList.add('hidden'), 5000);
                return;
            }
            
            if (selectedCelebrants.size === 0) {
                errorMessage.textContent = 'Please select at least one graduate you are celebrating with.';
                errorMessage.classList.remove('hidden');
                setTimeout(() => errorMessage.classList.add('hidden'), 5000);
                return;
            }

            submitBtn.disabled = true;
            submitBtn.textContent = 'Submitting...';
            successMessage.classList.add('hidden');
            errorMessage.classList.add('hidden');

            const formData = new FormData();
            formData.append('access_key', CONFIG.web3formsAccessKey);
            formData.append('name', guestName);
            formData.append('email', guestEmail || 'Not provided');
            formData.append('celebrating', celebrantsInput.value);
            formData.append('notes', notes || 'None');
            formData.append('timestamp', new Date().toISOString());
            formData.append('subject', 'New RSVP - Convocation Ceremony 2025');

            try {
                const response = await fetch(CONFIG.web3formsEndpoint, {
                    method: 'POST',
                    body: formData
                });

                const result = await response.json();

                if (result.success) {
                    successMessage.textContent = `Thank you, ${guestName}! Your RSVP has been confirmed. We look forward to celebrating with you!`;
                    successMessage.classList.remove('hidden');
                    
                    document.getElementById('guestName').value = '';
                    document.getElementById('guestEmail').value = '';
                    document.getElementById('notes').value = '';
                    selectedCelebrants.clear();
                    celebrantCards.forEach(card => card.classList.remove('selected'));
                    celebrantsInput.value = '';
                    
                    confetti({
                        particleCount: 80,
                        spread: 60,
                        origin: { y: 0.7 },
                        colors: ['#1e3a8a', '#d4af37', '#f4d03f']
                    });
                    
                    setTimeout(() => {
                        successMessage.classList.add('hidden');
                    }, 8000);
                } else {
                    throw new Error(result.message || 'Submission failed');
                }
            } catch (error) {
                console.error('Submission error:', error);
                errorMessage.textContent = 'Unable to submit your RSVP. Please try again or contact the organizers directly.';
                errorMessage.classList.remove('hidden');
            } finally {
                submitBtn.disabled = false;
                submitBtn.textContent = 'Confirm Attendance';
            }
        });

        // ========== GOOGLE SHEETS INTEGRATION ==========
        function parseCSV(csvText) {
            const lines = csvText.trim().split('\n');
            const guests = [];
            
            for (let i = 1; i < lines.length; i++) {
                const line = lines[i].trim();
                if (!line) continue;
                
                const values = [];
                let current = '';
                let inQuotes = false;
                
                for (let char of line) {
                    if (char === '"') {
                        inQuotes = !inQuotes;
                    } else if (char === ',' && !inQuotes) {
                        values.push(current.trim().replace(/^"|"$/g, ''));
                        current = '';
                    } else {
                        current += char;
                    }
                }
                values.push(current.trim().replace(/^"|"$/g, ''));
                
                if (values.length >= 2) {
                    guests.push({
                        name: values[0] || 'Unknown Guest',
                        celebrating: values[2] || 'Not specified',
                        email: values[1] || '',
                        notes: values[3] || ''
                    });
                }
            }
            
            return guests;
        }

        async function loadGuestList() {
            const loadingState = document.getElementById('loadingState');
            const guestTable = document.getElementById('guestTable');
            const guestTableBody = document.getElementById('guestTableBody');
            const lastUpdated = document.getElementById('lastUpdated');

            try {
                const sheetUrl = CONFIG.googleSheetUrl;
                
                if (sheetUrl === 'YOUR_GOOGLE_SHEET_CSV_URL_HERE') {
                    throw new Error('Google Sheet URL not configured. Please update CONFIG.googleSheetUrl with your published CSV URL.');
                }

                const response = await fetch(sheetUrl);
                
                if (!response.ok) {
                    throw new Error('Failed to fetch guest list from Google Sheets');
                }

                const csvText = await response.text();
                const guests = parseCSV(csvText);

                const totalCount = guests.length;
                const celebrantNames = new Set();
                
                guests.forEach(guest => {
                    const names = guest.celebrating.split(',').map(n => n.trim());
                    names.forEach(name => {
                        if (name && name !== 'Not specified') {
                            celebrantNames.add(name);
                        }
                    });
                });

                document.getElementById('totalCount').textContent = totalCount;
                document.getElementById('celebrantsCount').textContent = celebrantNames.size;

                guestTableBody.innerHTML = guests.map((guest, index) => {
                    const celebrants = guest.celebrating.split(',').map(n => n.trim()).filter(n => n && n !== 'Not specified');
                    const celebrantTags = celebrants.length > 0 
                        ? celebrants.map(name => `<span class="celebrant-tag">${escapeHtml(name)}</span>`).join('')
                        : '<span style="color: #999; font-style: italic;">Not specified</span>';
                    
                    return `
                        <tr>
                            <td class="guest-number">${index + 1}</td>
                            <td><strong>${escapeHtml(guest.name)}</strong></td>
                            <td><div class="celebrant-tags">${celebrantTags}</div></td>
                        </tr>
                    `;
                }).join('');

                lastUpdated.textContent = `Last updated: ${new Date().toLocaleString()}`;

                loadingState.classList.add('hidden');
                guestTable.classList.remove('hidden');

                setTimeout(() => {
                    confetti({
                        particleCount: 50,
                        spread: 60,
                        origin: { y: 0.4 },
                        colors: ['#1e3a8a', '#d4af37', '#f4d03f']
                    });
                }, 500);

            } catch (error) {
                console.error('Error loading guest list:', error);
                loadingState.innerHTML = `
                    <p style="color: #8B1538; font-weight: 600;">Unable to load guest list</p>
                    <p style="font-size: 14px; margin-top: 15px; color: #666;">${error.message}</p>
                    <p style="font-size: 13px; margin-top: 10px; color: #999;">Please ensure your Google Sheet is published to web as CSV.</p>
                `;
            }
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // ========== PAGE NAVIGATION ==========
        function showGuestList() {
            document.getElementById('invitationPage').classList.add('hidden');
            document.getElementById('guestListPage').classList.remove('hidden');
            loadGuestList();
        }

        function showInvitation() {
            document.getElementById('guestListPage').classList.add('hidden');
            document.getElementById('invitationPage').classList.remove('hidden');
        }
    </script>
</body>
</html>